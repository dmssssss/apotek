<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport"content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
    <title>HOSTERWEB - CV. Rizky Jaya Indosoft | Manajemen Apotek v1.0</title>
    <link rel="stylesheet" href="../bootstrap/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"/>
    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../dist/css/AdminLTE.min.css" />
    <link rel="stylesheet" href="../dist/css/skins/_all-skins.min.css" />
    <link rel="stylesheet" href="../plugins/iCheck/flat/blue.css" />
    <link rel="stylesheet" href="../plugins/morris/morris.css" />
    <link rel="stylesheet" href="../plugins/jvectormap/jquery-jvectormap-1.2.2.css"/>
    <link rel="stylesheet" href="../plugins/datepicker/datepicker3.css" />
    <link rel="stylesheet"href="../plugins/daterangepicker/daterangepicker-bs3.css"/>
    <link rel="stylesheet" href="../plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css"/>
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
  </head>

  <body class="hold-transition skin-blue sidebar-mini">
    <div class="wrapper">
      <header class="main-header">
        <a href ="dashboard_admin.html" class="logo">          
          <span class="logo-mini"><i class="fa fa-circle-plus"></i></span>
          <span class="logo-lg"><i class="fa fa-circle-plus"></i> Apotek</span>
        </a>
        <nav class="navbar navbar-static-top" role="navigation">
          <a
            href="#"
            class="sidebar-toggle"
            data-toggle="offcanvas"
            role="button"
          >
            <span class="sr-only">Toggle navigation</span>
          </a>
          
          <div class="navbar-custom-menu">
             <ul class="nav navbar-nav">
              <li >
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                  <i class="fa fa-user"></i> User : Admin</a>
                </a>
              </li>
              <li>
                <a href="../login_admin.html" > <i class="fa fa-sign-out"></i>Keluar</a>
            </li>
        </ul>
      </div>

        </nav>
      </header>

      <aside class="main-sidebar">
        <section class="sidebar">
          <ul class="sidebar-menu">           
            <li>
              <a href="dashboard_admin.html">
                <i class="fa fa-house"></i> <span> Dashboard</span>
              </a>
            </li>
            <li>
              <a href="data_pasien.html">
                <i class="fa fa-hospital-user"></i> <span> Data Pasien</span>
              </a>
            </li>
            <li>
              <a href="data_obat.html">
                <i class="fa fa-pills"></i> <span> Data Obat</span>
              </a>
            </li>
            <li>
              <a href="layanan_khusus.html">
                <i class="fa fa-hands-helping"></i> <span> Layanan Khusus </span>
              </a>
            </li>
            <li>
              <a href="laporan.html">
                <i class="fa fa-file-alt "></i> <span> Laporan</span>
              </a>
            </li>                     
          </ul>
        </section>
      </aside>

      <!-- Konten Dashboard -->
<div class="content-wrapper">        
  <!-- Content Header (Page header) -->
  <section class="content-header">
    <h1>
      <i class="fa fa-user-md"></i> Layanan Konsultasi Medis
      <small>Sistem Rekomendasi Terintegrasi AI</small>
    </h1>
    <ol class="breadcrumb">
      <li><a href="#"><i class="fa fa-dashboard"></i> Dashboard</a></li>
      <li class="active">Layanan Khusus</li>
    </ol>
  </section>

  <!-- Main content -->
  <section class="content">  

    <!-- Info boxes -->
    <div class="row">
      <div class="col-md-3 col-sm-6 col-xs-12">
        <div class="info-box">
          <span class="info-box-icon bg-aqua"><i class="fa fa-clipboard"></i></span>
          <div class="info-box-content">
            <span class="info-box-text">Total Rekomendasi</span>
            <span class="info-box-number" id="totalRekomendasi">156</span>
          </div>
        </div>
      </div>
      
      <div class="col-md-3 col-sm-6 col-xs-12">
        <div class="info-box">
          <span class="info-box-icon bg-green"><i class="fa fa-calendar-check-o"></i></span>
          <div class="info-box-content">
            <span class="info-box-text">Hari Ini</span>
            <span class="info-box-number" id="rekomendasisHariIni">28</span>
          </div>
        </div>
      </div>
      
      <div class="col-md-3 col-sm-6 col-xs-12">
        <div class="info-box">
          <span class="info-box-icon bg-yellow"><i class="fa fa-clock-o"></i></span>
          <div class="info-box-content">
            <span class="info-box-text">Pending Follow-up</span>
            <span class="info-box-number" id="pendingFollowup">12</span>
          </div>
        </div>
      </div>
      
      <div class="col-md-3 col-sm-6 col-xs-12">
        <div class="info-box">
          <span class="info-box-icon bg-red"><i class="fa fa-exclamation-triangle"></i></span>
          <div class="info-box-content">
            <span class="info-box-text">Kasus Mendesak</span>
            <span class="info-box-number" id="urgentCases">3</span>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <!-- Service Overview -->
      <div class="col-md-4">
        <div class="box box-primary">
          <div class="box-header with-border text-center">
            <h3 class="box-title"><i class="fa fa-user-md"></i> Layanan Konsultasi Khusus</h3>
          </div>
          <div class="box-body text-center">
            <div style="padding: 20px 0;">
              <i class="fa fa-stethoscope" style="font-size: 64px; color: #3c8dbc; margin-bottom: 20px;"></i>
              <p style="font-size: 16px; line-height: 1.6;">
                Sistem konsultasi medis terintegrasi dengan<br>                
              </p>
            </div>
            <button class="btn btn-primary btn-lg btn-block" onclick="startFlow()" style="margin-bottom: 10px;">
              <i class="fa fa-play-circle"></i> Mulai Layanan Baru
            </button>
            <button class="btn btn-default btn-block" onclick="showHistory()">
              <i class="fa fa-history"></i> Lihat Riwayat
            </button>
          </div>
        </div>
      </div>

      <!-- Main Flow Process -->
      <div class="col-md-8">
        <div class="box box-solid">
          <div class="box-header with-border">
            <h3 class="box-title"><i class="fa fa-sitemap"></i> Alur Layanan Khusus</h3>
            <div class="box-tools pull-right">
              <span class="btn label-info" id="currentStep">Siap Memulai</span>
            </div>
          </div>
          <div class="box-body">
            
            <!-- Progress Bar -->
            <div class="progress progress-sm" style="margin-bottom: 20px;">
              <div class="progress-bar progress-bar-primary progress-bar-striped active" id="progressBar" style="width: 0%"></div>
            </div>
            
            <!-- Initial State -->
            <div id="initialState">
              <div class="callout callout-info">
                <h4><i class="fa fa-info-circle"></i> Selamat Datang di Layanan Konsultasi Khusus</h4>
                <div class="row">
                  <div class="col-md-8">
                    <p><strong>Layanan khusus memungkinkan Anda untuk:</strong></p>
                    <ul>
                      <li>Membuat rekomendasi personal berdasarkan kondisi pasien</li>
                      <li>Menggunakan template yang telah tersedia</li>
                      <li>Mengirim rekomendasi melalui berbagai metode</li>
                      <li>Menjadwalkan follow-up otomatis</li>
                      <li>Tracking dan monitoring hasil</li>
                    </ul>
                  </div>
                  <div class="col-md-4 text-center">
                    <i class="fa fa-rocket" style="font-size: 60px; color: #17a2b8; opacity: 0.7;"></i>
                  </div>
                </div>
                <p class="text-center"><strong>Klik "Mulai Layanan Baru" untuk memulai proses</strong></p>
              </div>
            </div>

            <!-- Flow Process -->
            <div id="flowContainer" style="display: none;">
              
              <!-- Step 1: Patient Selection -->
              <div class="timeline" id="step1">
                <div class="time-label">
                  <span class="bg-blue"><i class="fa fa-user"></i> Step 1: Pilih Pasien</span>
                </div>
                <div>
                  <i class="fa fa-users bg-blue"></i>
                  <div class="timeline-item">
                    <div class="timeline-header">
                      <strong><i class="fa fa-search"></i> Pilih atau Tambah Data Pasien</strong>
                    </div>
                    <div class="timeline-body">
                      <div class="row">
                        <div class="col-md-8">
                          <div class="form-group">
                            <label>Cari Pasien (Nama/RM)</label>
                            <div class="input-group">
                              <input type="text" class="form-control" placeholder="Ketik nama atau nomor RM..." id="patientSearch">
                              <span class="input-group-btn">
                                <button class="btn btn-info" onclick="searchPatient()">
                                  <i class="fa fa-search"></i>
                                </button>
                              </span>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-4">
                          <label>&nbsp;</label><br>
                          <button class="btn btn-success btn-block" onclick="addNewPatient()">
                            <i class="fa fa-plus"></i> Pasien Baru
                          </button>
                        </div>
                      </div>
                      
                      <!-- Patient Results -->
                      <div id="patientResults" style="display: none;">
                        <h5><i class="fa fa-list"></i> Hasil Pencarian:</h5>
                        <div class="table-responsive">
                          <table class="table table-bordered table-hover">
                            <thead>
                              <tr>
                                <th><i class="fa fa-user"></i> Nama</th>
                                <th><i class="fa fa-id-card"></i> No. RM</th>
                                <th><i class="fa fa-birthday-cake"></i> Umur</th>
                                <th><i class="fa fa-calendar"></i> Terakhir Konsultasi</th>
                                <th><i class="fa fa-cogs"></i> Aksi</th>
                              </tr>
                            </thead>
                            <tbody id="patientTableBody">
                              <!-- Dynamic content -->
                            </tbody>
                          </table>
                        </div>
                      </div>
                      
                      <!-- Selected Patient Info -->
                      <div id="selectedPatient" style="display: none;">
                        <div class="callout callout-success">
                          <h4><i class="fa fa-user-circle"></i> Pasien Terpilih</h4>
                          <div class="row">
                            <div class="col-md-6">
                              <p><strong><i class="fa fa-user"></i> Nama:</strong> <span id="selectedName">-</span></p>
                              <p><strong><i class="fa fa-id-card"></i> No. RM:</strong> <span id="selectedRM">-</span></p>
                              <p><strong><i class="fa fa-birthday-cake"></i> Umur:</strong> <span id="selectedAge">-</span></p>
                            </div>
                            <div class="col-md-6">
                              <p><strong><i class="fa fa-venus-mars"></i> Jenis Kelamin:</strong> <span id="selectedGender">-</span></p>
                              <p><strong><i class="fa fa-home"></i> Alamat:</strong> <span id="selectedAddress">-</span></p>
                              <p><strong><i class="fa fa-phone"></i> Telepon:</strong> <span id="selectedPhone">-</span></p>
                            </div>
                          </div>
                          <div class="text-center" style="margin-top: 15px;">
                            <button class="btn btn-primary btn-lg" onclick="proceedToStep2()">
                              <i class="fa fa-arrow-right"></i> Lanjut ke Assessment
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Step 2: Medical Assessment & Recommendation -->
              <div class="timeline" id="step2" style="display: none;">
                <div class="time-label">
                  <span class="bg-yellow"><i class="fa fa-stethoscope"></i> Step 2: Assessment & Rekomendasi</span>
                </div>
                <div>
                  <i class="fa fa-clipboard bg-yellow"></i>
                  <div class="timeline-item">
                    <div class="timeline-header">
                      <strong><i class="fa fa-user-md"></i> Pemeriksaan & Buat Rekomendasi Personal</strong>
                    </div>
                    <div class="timeline-body">
                      <form id="assessmentForm">
                        
                        <!-- Vital Signs Section -->
                        <div class="box box-info">
                          <div class="box-header with-border">
                            <h3 class="box-title"><i class="fa fa-heartbeat"></i> Vital Signs</h3>
                          </div>
                          <div class="box-body">
                            <div class="row">
                              <div class="col-md-6">
                                <div class="form-group">
                                  <label><i class="fa fa-tint text-red"></i> Tekanan Darah</label>
                                  <input type="text" class="form-control" placeholder="120/80 mmHg">
                                </div>
                                <div class="form-group">
                                  <label><i class="fa fa-thermometer-half text-orange"></i> Suhu</label>
                                  <input type="text" class="form-control" placeholder="36.5¬∞C">
                                </div>
                              </div>
                              <div class="col-md-6">
                                <div class="form-group">
                                  <label><i class="fa fa-heartbeat text-red"></i> Nadi</label>
                                  <input type="text" class="form-control" placeholder="80 bpm">
                                </div>
                                <div class="form-group">
                                  <label><i class="fa fa-wind text-blue"></i> Respirasi</label>
                                  <input type="text" class="form-control" placeholder="20/menit">
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>

                        <!-- Symptoms Section -->
                        <div class="box box-warning">
                          <div class="box-header with-border">
                            <h3 class="box-title"><i class="fa fa-comments"></i> Keluhan & Gejala</h3>
                          </div>
                          <div class="box-body">
                            <div class="form-group">
                              <label><i class="fa fa-exclamation-circle"></i> Keluhan Utama</label>
                              <textarea class="form-control" rows="3" placeholder="Jelaskan keluhan utama pasien..."></textarea>
                            </div>
                            <div class="form-group">
                              <label><i class="fa fa-history"></i> Riwayat Penyakit Sekarang</label>
                              <textarea class="form-control" rows="3" placeholder="Riwayat penyakit sekarang..."></textarea>
                            </div>
                          </div>
                        </div>
                        
                        <!-- Diagnosis & Recommendation Section -->
                        <div class="box box-success">
                          <div class="box-header with-border">
                            <h3 class="box-title"><i class="fa fa-user-md"></i> Diagnosis & Rekomendasi</h3>
                            <div class="box-tools pull-right">
                              <button type="button" class="btn btn-sm btn-primary" onclick="showTemplates()">
                                <i class="fa fa-book"></i> Template
                              </button>
                              <button type="button" class="btn btn-sm btn-info" onclick="aiAssistant()">
                                <i class="fa fa-magic"></i> AI Assistant
                              </button>
                            </div>
                          </div>
                          <div class="box-body">
                            <div class="row">
                              <div class="col-md-6">
                                <div class="form-group">
                                  <label><i class="fa fa-stethoscope"></i> Diagnosis Primer</label>
                                  <input type="text" class="form-control" placeholder="Diagnosis utama...">
                                </div>
                                <div class="form-group">
                                  <label><i class="fa fa-plus-square"></i> Diagnosis Sekunder</label>
                                  <input type="text" class="form-control" placeholder="Diagnosis tambahan...">
                                </div>
                                <div class="form-group">
                                  <label><i class="fa fa-flag"></i> Tingkat Prioritas</label>
                                  <select class="form-control">
                                    <option value="normal">Normal</option>
                                    <option value="mendesak">Mendesak</option>
                                    <option value="sangat-mendesak">Sangat Mendesak</option>
                                    <option value="darurat">Darurat</option>
                                  </select>
                                </div>
                              </div>
                              <div class="col-md-6">
                                <div class="form-group">
                                  <label><i class="fa fa-pills"></i> Rekomendasi Pengobatan</label>
                                  <textarea class="form-control" rows="4" placeholder="Detail rekomendasi pengobatan..."></textarea>
                                </div>
                                <div class="form-group">
                                  <label><i class="fa fa-cutlery"></i> Lifestyle & Diet</label>
                                  <textarea class="form-control" rows="2" placeholder="Rekomendasi gaya hidup dan diet..."></textarea>
                                </div>
                              </div>
                            </div>
                            
                            <div class="row">
                              <div class="col-md-4">
                                <div class="form-group">
                                  <label><i class="fa fa-calendar-plus-o"></i> Follow-up Date</label>
                                  <input type="date" class="form-control">
                                </div>
                              </div>
                              <div class="col-md-4">
                                <div class="form-group">
                                  <label><i class="fa fa-user-md"></i> Dokter Rujukan</label>
                                  <select class="form-control">
                                    <option>Pilih dokter...</option>
                                    <option>Dr. Ahmad - Spesialis Dalam</option>
                                    <option>Dr. Sari - Spesialis Jantung</option>
                                    <option>Dr. Budi - Spesialis Paru</option>
                                  </select>
                                </div>
                              </div>
                              <div class="col-md-4">
                                <div class="form-group">
                                  <label><i class="fa fa-flask"></i> Lab/Pemeriksaan</label>
                                  <select class="form-control" multiple>
                                    <option>Darah Lengkap</option>
                                    <option>Gula Darah</option>
                                    <option>Kolesterol</option>
                                    <option>Rontgen Thorax</option>
                                    <option>EKG</option>
                                  </select>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="box-footer text-center">
                            <button type="button" class="btn btn-success btn-lg" onclick="saveAssessment()">
                              <i class="fa fa-save"></i> Simpan & Lanjutkan
                            </button>
                            <button type="button" class="btn btn-default" onclick="previewRecommendation()">
                              <i class="fa fa-eye"></i> Preview
                            </button>
                          </div>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Step 3: Send to Patient -->
              <div class="timeline" id="step3" style="display: none;">
                <div class="time-label">
                  <span class="bg-green"><i class="fa fa-send"></i> Step 3: Kirim ke Pasien</span>
                </div>
                <div>
                  <i class="fa fa-paper-plane bg-green"></i>
                  <div class="timeline-item">
                    <div class="timeline-header">
                      <strong><i class="fa fa-share"></i> Pengiriman Rekomendasi & Follow-up</strong>
                    </div>
                    <div class="timeline-body">
                      <div class="row">
                        <div class="col-md-6">
                          <div class="box box-primary">
                            <div class="box-header with-border">
                              <h4 class="box-title"><i class="fa fa-share"></i> Metode Pengiriman</h4>
                            </div>
                            <div class="box-body">
                              <div class="form-group">
                                <label>Pilih Metode</label>
                                <select class="form-control" onchange="toggleDeliveryMethod(this)" id="deliveryMethod">
                                  <option value="">Pilih metode...</option>
                                  <option value="email">üìß Email</option>
                                  <option value="whatsapp">üí¨ WhatsApp</option>
                                  <option value="sms">üì± SMS</option>
                                  <option value="print">üñ®Ô∏è Print/Cetak</option>
                                  <option value="portal">üåê Patient Portal</option>
                                </select>
                              </div>
                              
                              <div id="contactDetails" style="display: none;">
                                <div class="form-group">
                                  <label id="contactLabel">Kontak</label>
                                  <div class="input-group">
                                    <input type="text" class="form-control" id="contactInput" placeholder="Masukkan kontak">
                                    <span class="input-group-btn">
                                      <button class="btn btn-info" onclick="validateContact()">
                                        <i class="fa fa-check"></i>
                                      </button>
                                    </span>
                                  </div>
                                </div>
                              </div>

                              <div class="form-group">
                                <label>Template Pesan</label>
                                <select class="form-control" onchange="loadMessageTemplate(this)">
                                  <option>Pilih template...</option>
                                  <option value="formal">Formal</option>
                                  <option value="friendly">Ramah</option>
                                  <option value="urgent">Mendesak</option>
                                </select>
                              </div>
                              
                              <div class="form-group">
                                <label>Pesan Tambahan</label>
                                <textarea class="form-control" rows="4" id="additionalMessage" placeholder="Pesan tambahan untuk pasien..."></textarea>
                              </div>
                            </div>
                          </div>
                        </div>
                        
                        <div class="col-md-6">
                          <div class="box box-info">
                            <div class="box-header with-border">
                              <h4 class="box-title"><i class="fa fa-cogs"></i> Pengaturan Tambahan</h4>
                            </div>
                            <div class="box-body">
                              <div class="form-group">
                                <div class="checkbox">
                                  <label>
                                    <input type="checkbox" checked> Kirim salinan ke rekam medis elektronik
                                  </label>
                                </div>
                                <div class="checkbox">
                                  <label>
                                    <input type="checkbox"> Jadwalkan follow-up otomatis
                                  </label>
                                </div>
                                <div class="checkbox">
                                  <label>
                                    <input type="checkbox"> Kirim reminder sebelum follow-up
                                  </label>
                                </div>
                                <div class="checkbox">
                                  <label>
                                    <input type="checkbox"> CC ke keluarga (jika ada)
                                  </label>
                                </div>
                              </div>
                              
                              <div class="form-group">
                                <label>Priority Pengiriman</label>
                                <select class="form-control">
                                  <option>Normal</option>
                                  <option>High Priority</option>
                                  <option>Urgent</option>
                                </select>
                              </div>
                              
                              <div class="form-group">
                                <label>Jadwal Pengiriman</label>
                                <div class="radio">
                                  <label>
                                    <input type="radio" name="schedule" value="now" checked> Kirim sekarang
                                  </label>
                                </div>
                                <div class="radio">
                                  <label>
                                    <input type="radio" name="schedule" value="later"> Jadwalkan nanti
                                  </label>
                                </div>
                                <input type="datetime-local" class="form-control" style="margin-top: 10px; display: none;" id="scheduleTime">
                              </div>
                            </div>
                            
                            <div class="box-footer text-center">
                              <button type="button" class="btn btn-success btn-lg btn-block" onclick="sendRecommendation()">
                                <i class="fa fa-rocket"></i> Kirim Rekomendasi
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- End Timeline -->
              <div class="timeline" id="timelineEnd" style="display: none;">
                <div class="time-label">
                  <span class="bg-gray"><i class="fa fa-clock-o"></i> Selesai</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Success Modal -->
    <div class="modal modal-success fade" id="successModal">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title"><i class="fa fa-check-circle"></i> Berhasil!</h4>
          </div>
          <div class="modal-body">
            <div class="text-center">
              <i class="fa fa-check-circle"></i>
              <h3>Rekomendasi Berhasil Dikirim!</h3>
              <p id="successMessage">Rekomendasi telah dikirim ke pasien dan tersimpan dalam sistem.</p>
              <div class="alert alert-info">
                <strong>Reference ID:</strong> <span id="referenceId">REC-2024-001</span>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-success" onclick="printReceipt()">
              <i class="fa fa-print"></i> Cetak Bukti
            </button>
            <button type="button" class="btn btn-primary" onclick="startNewService()">
              <i class="fa fa-plus"></i> Layanan Baru
            </button>
            <button type="button" class="btn btn-default" data-dismiss="modal">
              <i class="fa fa-close"></i> Tutup
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Template Modal -->
    <div class="modal fade" id="templateModal">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title"><i class="fa fa-book"></i> Template Rekomendasi</h4>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-md-4">
                <div class="list-group" id="templateList">
                  <a href="#" class="list-group-item active" onclick="selectTemplate('diabetes')">
                    <i class="fa fa-heartbeat"></i> Diabetes Mellitus
                  </a>
                  <a href="#" class="list-group-item" onclick="selectTemplate('hipertensi')">
                    <i class="fa fa-tint"></i> Hipertensi
                  </a>
                  <a href="#" class="list-group-item" onclick="selectTemplate('jantung')">
                    <i class="fa fa-heart"></i> Penyakit Jantung
                  </a>
                  <a href="#" class="list-group-item" onclick="selectTemplate('respiratory')">
                    <i class="fa fa-lungs"></i> Gangguan Pernapasan
                  </a>
                </div>
              </div>
              <div class="col-md-8">
                <div id="templateContent">
                  <h4>Template Diabetes Mellitus</h4>
                  <div class="well">
                    <p><strong>Diagnosis:</strong> Diabetes Mellitus Tipe 2</p>
                    <p><strong>Rekomendasi:</strong></p>
                    <ul>
                      <li>Kontrol gula darah rutin</li>
                      <li>Diet rendah gula dan karbohidrat</li>
                      <li>Olahraga teratur 30 menit/hari</li>
                      <li>Minum obat sesuai anjuran dokter</li>
                    </ul>
                    <p><strong>Follow-up:</strong> 2 minggu</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" onclick="applyTemplate()">
              <i class="fa fa-check"></i> Gunakan Template
            </button>
            <button type="button" class="btn btn-default" data-dismiss="modal">
              <i class="fa fa-close"></i> Batal
            </button>
          </div>
        </div>
      </div>
    </div>

  </section>
</div>

<script>
// Global variables
let currentStep = 0;
let selectedPatientData = null;
let assessmentData = null;

// Initialize
$(document).ready(function() {
  updateStats();
  initializeEventListeners();
});

function updateStats() {
  // Simulate real-time stats update
  setInterval(() => {
    $('#totalRekomendasi').text(Math.floor(Math.random() * 50) + 140);
    $('#rekomendasisHariIni').text(Math.floor(Math.random() * 10) + 20);
    $('#pendingFollowup').text(Math.floor(Math.random() * 5) + 10);
    $('#urgentCases').text(Math.floor(Math.random() * 3) + 2);
  }, 30000);
}

function initializeEventListeners() {
  // Patient search with debounce
  let searchTimeout;
  $('#patientSearch').on('input', function() {
    clearTimeout(searchTimeout);
    searchTimeout = setTimeout(() => {
      if ($(this).val().length >= 3) {
        searchPatient();
      }
    }, 300);
  });
  
  // Schedule radio buttons
  $('input[name="schedule"]').change(function() {
    if ($(this).val() === 'later') {
      $('#scheduleTime').show();
    } else {
      $('#scheduleTime').hide();
    }
  });
}

function startFlow() {
  document.getElementById('initialState').style.display = 'none';
  document.getElementById('flowContainer').style.display = 'block';
  document.getElementById('step1').style.display = 'block';
  
  updateProgress(25);
  updateCurrentStep('Step 1: Pilih Pasien');
  
  // Focus on patient search
  setTimeout(() => {
    document.getElementById('patientSearch').focus();
  }, 500);
}

function updateProgress(percentage) {
  $('#progressBar').css('width', percentage + '%');
}

function updateCurrentStep(stepName) {
  $('#currentStep').text(stepName);
}

function searchPatient() {
  const query = document.getElementById('patientSearch').value;
  
  if (query.length < 3) return;
  
  // Show loading
  $('#patientResults').show();
  $('#patientTableBody').html('<tr><td colspan="5" class="text-center"><i class="fa fa-spinner fa-spin"></i> Mencari pasien...</td></tr>');
  
  // Simulate API call
  setTimeout(() => {
    const mockData = [
      {
        id: 1,
        nama: 'Ahmad Susanto',
        rm: 'RM001234',
        umur: 45,
        gender: 'Laki-laki',
        alamat: 'Jl. Merdeka No. 123, Jakarta',
        phone: '08123456789',
        lastVisit: '15 Aug 2024'
      },
      {
        id: 2,
        nama: 'Sari Dewi',
        rm: 'RM001235',
        umur: 38,
        gender: 'Perempuan',
        alamat: 'Jl. Sudirman No. 456, Jakarta',
        phone: '08198765432',
        lastVisit: '12 Aug 2024'
      }
    ];
    
    let tableHtml = '';
    mockData.forEach(patient => {
      tableHtml += `
        <tr>
          <td>${patient.nama}</td>
          <td>${patient.rm}</td>
          <td>${patient.umur} tahun</td>
          <td>${patient.lastVisit}</td>
          <td>
            <button class="btn btn-sm btn-primary" onclick="selectPatient(${JSON.stringify(patient).replace(/"/g, '&quot;')})">
              <i class="fa fa-check"></i> Pilih
            </button>
          </td>
        </tr>
      `;
    });
    
    $('#patientTableBody').html(tableHtml);
  }, 1000);
}

function selectPatient(patient) {
  selectedPatientData = patient;
  
  // Update selected patient info
  $('#selectedName').text(patient.nama);
  $('#selectedRM').text(patient.rm);
  $('#selectedAge').text(patient.umur + ' tahun');
  $('#selectedGender').text(patient.gender);
  $('#selectedAddress').text(patient.alamat);
  $('#selectedPhone').text(patient.phone);
  
  // Show selected patient section
  $('#patientResults').hide();
  $('#selectedPatient').show();
}

function addNewPatient() {
  // Simulate adding new patient
  alert('Fitur tambah pasien baru akan membuka form registrasi.');
}

function proceedToStep2() {
  if (!selectedPatientData) {
    alert('Silakan pilih pasien terlebih dahulu.');
    return;
  }
  
  // Hide step 1 and show step 2
  document.getElementById('step1').style.display = 'none';
  document.getElementById('step2').style.display = 'block';
  
  updateProgress(50);
  updateCurrentStep('Step 2: Assessment');
  
  // Scroll to step 2
  document.getElementById('step2').scrollIntoView({ behavior: 'smooth' });
}

function showTemplates() {
  $('#templateModal').modal('show');
}

function selectTemplate(type) {
  // Remove active class from all items
  $('#templateList .list-group-item').removeClass('active');
  
  // Add active class to selected item
  $(`#templateList .list-group-item[onclick="selectTemplate('${type}')"]`).addClass('active');
  
  // Update template content based on type
  const templates = {
    diabetes: {
      title: 'Template Diabetes Mellitus',
      diagnosis: 'Diabetes Mellitus Tipe 2',
      recommendations: [
        'Kontrol gula darah rutin',
        'Diet rendah gula dan karbohidrat',
        'Olahraga teratur 30 menit/hari',
        'Minum obat sesuai anjuran dokter'
      ],
      followup: '2 minggu'
    },
    hipertensi: {
      title: 'Template Hipertensi',
      diagnosis: 'Hipertensi Primer',
      recommendations: [
        'Kontrol tekanan darah rutin',
        'Diet rendah garam',
        'Olahraga teratur',
        'Hindari stress berlebihan'
      ],
      followup: '1 bulan'
    },
    jantung: {
      title: 'Template Penyakit Jantung',
      diagnosis: 'Penyakit Jantung Koroner',
      recommendations: [
        'Kontrol kolesterol',
        'Diet rendah lemak jenuh',
        'Olahraga ringan teratur',
        'Konsumsi obat pengencer darah'
      ],
      followup: '2 minggu'
    }
  };
  
  const template = templates[type];
  if (template) {
    let content = `
      <h4>${template.title}</h4>
      <div class="well">
        <p><strong>Diagnosis:</strong> ${template.diagnosis}</p>
        <p><strong>Rekomendasi:</strong></p>
        <ul>
          ${template.recommendations.map(rec => `<li>${rec}</li>`).join('')}
        </ul>
        <p><strong>Follow-up:</strong> ${template.followup}</p>
      </div>
    `;
    $('#templateContent').html(content);
  }
}

function applyTemplate() {
  // Apply selected template to form
  alert('Template berhasil diterapkan ke form!');
  $('#templateModal').modal('hide');
}

function aiAssistant() {
  alert('Fitur AI Assistant akan segera tersedia!');
}

function saveAssessment() {
  // Validate form
  const diagnosis = document.querySelector('input[placeholder="Diagnosis utama..."]').value;
  
  if (!diagnosis.trim()) {
    alert('Silakan isi diagnosis terlebih dahulu.');
    return;
  }
  
  // Save assessment data
  assessmentData = {
    vitals: {
      bloodPressure: document.querySelector('input[placeholder="120/80 mmHg"]').value,
      pulse: document.querySelector('input[placeholder="80 bpm"]').value,
      temperature: document.querySelector('input[placeholder="36.5¬∞C"]').value,
      respiration: document.querySelector('input[placeholder="20/menit"]').value
    },
    diagnosis: diagnosis,
    recommendations: document.querySelector('textarea[placeholder="Detail rekomendasi pengobatan..."]').value
  };
  
  // Hide step 2 and show step 3
  document.getElementById('step2').style.display = 'none';
  document.getElementById('step3').style.display = 'block';
  
  updateProgress(75);
  updateCurrentStep('Step 3: Kirim ke Pasien');
  
  // Scroll to step 3
  document.getElementById('step3').scrollIntoView({ behavior: 'smooth' });
}

function previewRecommendation() {
  alert('Fitur preview rekomendasi akan menampilkan hasil dalam format PDF.');
}

function toggleDeliveryMethod(select) {
  const method = select.value;
  const contactDetails = document.getElementById('contactDetails');
  const contactLabel = document.getElementById('contactLabel');
  const contactInput = document.getElementById('contactInput');
  
  if (method) {
    contactDetails.style.display = 'block';
    
    switch(method) {
      case 'email':
        contactLabel.textContent = 'Email Address';
        contactInput.placeholder = 'Masukkan alamat email';
        contactInput.type = 'email';
        break;
      case 'whatsapp':
      case 'sms':
        contactLabel.textContent = 'Nomor Telepon';
        contactInput.placeholder = 'Masukkan nomor telepon';
        contactInput.type = 'tel';
        break;
      case 'print':
        contactDetails.style.display = 'none';
        break;
      case 'portal':
        contactLabel.textContent = 'Patient ID';
        contactInput.placeholder = 'Masukkan Patient ID';
        contactInput.type = 'text';
        break;
    }
  } else {
    contactDetails.style.display = 'none';
  }
}

function validateContact() {
  const method = document.getElementById('deliveryMethod').value;
  const contact = document.getElementById('contactInput').value;
  
  if (!contact.trim()) {
    alert('Silakan masukkan kontak yang valid.');
    return;
  }
  
  // Simple validation based on method
  let isValid = false;
  switch(method) {
    case 'email':
      isValid = /\S+@\S+\.\S+/.test(contact);
      break;
    case 'whatsapp':
    case 'sms':
      isValid = /^[\+]?[0-9\-\(\)\s]+$/.test(contact);
      break;
    default:
      isValid = true;
  }
  
  if (isValid) {
    alert('Kontak valid!');
    document.getElementById('contactInput').style.borderColor = 'green';
  } else {
    alert('Format kontak tidak valid!');
    document.getElementById('contactInput').style.borderColor = 'red';
  }
}

function loadMessageTemplate(select) {
  const template = select.value;
  const messageArea = document.getElementById('additionalMessage');
  
  const templates = {
    formal: 'Kepada Yth. Bapak/Ibu,\n\nBerikut adalah hasil konsultasi dan rekomendasi medis...',
    friendly: 'Halo,\n\nSemoga dalam keadaan sehat. Berikut adalah rekomendasi dari konsultasi hari ini...',
    urgent: 'PENTING - SEGERA DIBACA\n\nBerdasarkan hasil pemeriksaan, diperlukan tindak lanjut segera...'
  };
  
  if (templates[template]) {
    messageArea.value = templates[template];
  }
}

function sendRecommendation() {
  const method = document.getElementById('deliveryMethod').value;
  
  if (!method) {
    alert('Silakan pilih metode pengiriman terlebih dahulu.');
    return;
  }
  
  // Simulate sending process
  const btn = event.target;
  btn.innerHTML = '<i class="fa fa-spinner fa-spin"></i> Mengirim...';
  btn.disabled = true;
  
  setTimeout(() => {
    // Hide step 3 and show timeline end
    document.getElementById('step3').style.display = 'none';
    document.getElementById('timelineEnd').style.display = 'block';
    
    updateProgress(100);
    updateCurrentStep('Selesai');
    
    // Generate reference ID
    const refId = 'REC-' + new Date().getFullYear() + '-' + String(Date.now()).slice(-6);
    document.getElementById('referenceId').textContent = refId;
    
    // Show success modal
    $('#successModal').modal('show');
    
    // Reset button
    btn.innerHTML = '<i class="fa fa-rocket"></i> Kirim Rekomendasi';
    btn.disabled = false;
  }, 2000);
}

function printReceipt() {
  alert('Mencetak bukti pengiriman...');
}

function startNewService() {
  // Reset all steps
  document.getElementById('flowContainer').style.display = 'none';
  document.getElementById('initialState').style.display = 'block';
  
  // Reset all timeline steps
  document.getElementById('step1').style.display = 'none';
  document.getElementById('step2').style.display = 'none';
  document.getElementById('step3').style.display = 'none';
  document.getElementById('timelineEnd').style.display = 'none';
  
  // Reset data
  selectedPatientData = null;
  assessmentData = null;
  currentStep = 0;
  
  // Reset progress
  updateProgress(0);
  updateCurrentStep('Siap Memulai');
  
  // Reset forms
  document.getElementById('patientSearch').value = '';
  document.getElementById('assessmentForm').reset();
  
  // Hide patient sections
  document.getElementById('patientResults').style.display = 'none';
  document.getElementById('selectedPatient').style.display = 'none';
  
  // Close modal
  $('#successModal').modal('hide');
  
  // Scroll to top
  document.querySelector('.content').scrollIntoView({ behavior: 'smooth' });
}

function showHistory() {
  alert('Fitur riwayat akan menampilkan daftar konsultasi sebelumnya.');
}

function quickTemplate(type) {
  // Quick access to templates
  startFlow();
  setTimeout(() => {
    // Simulate patient selection for demo
    const demoPatient = {
      id: 999,
      nama: 'Demo Patient',
      rm: 'RM999999',
      umur: 40,
      gender: 'Laki-laki',
      alamat: 'Demo Address',
      phone: '08123456789'
    };
    selectPatient(demoPatient);
    
    setTimeout(() => {
      proceedToStep2();
      setTimeout(() => {
        showTemplates();
        selectTemplate(type);
      }, 500);
    }, 500);
  }, 1000);
}

function quickEmergency() {
  alert('Membuka form konsultasi darurat dengan prioritas tinggi.');
  startFlow();
}
</script>

      <!-- footer -->
     <footer class="main-footer ">
        <div class="pull-right hidden-xs">
          <i class="fa fa-calendar"></i> 07 Agustus 2025 ¬†&nbsp; <span id="waktu">12:09:07</span> ¬† &nbsp;<i class="fa fa-desktop"></i> Alamat Server : <input style="width:150px" readonly value="#">
        <div id="session" ></div>
    </div>
    <b>Manajemen Apotek 1.0</b> Copyright &copy; <a href="https://hosterweb.id/">Hosterweb Grup CV. Rizky Jaya Indosoft</a></footer>
 
</div>
      <!-- footer -->
      <script>
      function tampilkanWaktu() {
        const waktuSekarang = new Date();
        let jam = waktuSekarang.getHours();
        let menit = waktuSekarang.getMinutes();
        let detik = waktuSekarang.getSeconds();

        // Tambahkan angka 0 di depan jika jam, menit, atau detik < 10
        jam = jam < 10 ? "0" + jam : jam;
        menit = menit < 10 ? "0" + menit : menit;
        detik = detik < 10 ? "0" + detik : detik;

        document.getElementById("waktu").innerHTML = jam + ":" + menit + ":" + detik;
      }

      // Panggil fungsi sekali saat halaman dimuat
      tampilkanWaktu();

      // Perbarui waktu setiap 1 detik (1000 milidetik)
      setInterval(tampilkanWaktu, 1000);
    </script>

     <!-- jQuery 2.1.4 -->
    <script src="../plugins/jQuery/jQuery-2.1.4.min.js"></script>
    <!-- jQuery UI 1.11.4 -->
    <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
    <!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
    </script>
    <!-- Bootstrap 3.3.5 -->
    <script src="../bootstrap/js/bootstrap.min.js"></script>
    <!-- Morris.js charts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
    <script src="../plugins/morris/morris.min.js"></script>
    <!-- Sparkline -->
    <script src="../plugins/sparkline/jquery.sparkline.min.js"></script>
    <!-- jvectormap -->
    <script src="../plugins/jvectormap/jquery-jvectormap-1.2.2.min.js"></script>
    <script src="../plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
    <!-- jQuery Knob Chart -->
    <script src="../plugins/knob/jquery.knob.js"></script>
    <!-- daterangepicker -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.2/moment.min.js"></script>
    <script src="../plugins/daterangepicker/daterangepicker.js"></script>
    <!-- datepicker -->
    <script src="../plugins/datepicker/bootstrap-datepicker.js"></script>
    <!-- Bootstrap WYSIHTML5 -->
    <script src="../plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js"></script>
    <!-- Slimscroll -->
    <script src="../plugins/slimScroll/jquery.slimscroll.min.js"></script>
    <!-- FastClick -->
    <script src="../plugins/fastclick/fastclick.min.js"></script>
    <!-- AdminLTE App -->
    <script src="../dist/js/app.min.js"></script>
    <!-- AdminLTE dashboard demo (This is only for demo purposes) -->
    <script src="../dist/js/pages/dashboard.js"></script>
    <!-- AdminLTE for demo purposes -->
    <script src="../dist/js/demo.js"></script>     

    </div>
  </body>
</html>
